<metal:block use-macro="main_template" i18n:domain="eucaconsole">

    <head metal:fill-slot="head_css">
        <link rel="stylesheet" type="text/css" href="${request.static_path('eucaconsole:static/js/thirdparty/magic-search/magic_search.css')}"/>
        <link rel="stylesheet" type="text/css" href="${request.static_path('eucaconsole:static/css/pages/alarm_history.css')}"/>
    </head>

    <div metal:fill-slot="main_content">
        <div class="row" id="contentwrap" ng-app="AlarmHistoryPage">
            <metal:breadcrumbs metal:use-macro="layout.global_macros['breadcrumbs']">
                <metal:crumbs metal:fill-slot="crumbs">
                    <li><a href="${request.route_path('cloudwatch_alarms')}" i18n:translate="">
                            CloudWatchAlarms</a></li>
                    <li><a href="${request.route_path('cloudwatch_alarm_view', alarm_id=alarm_id)}">${alarm_id}</a></li>
                    <li class="current"><a href="#">History</a></li>
                </metal:crumbs>
            </metal:breadcrumbs>
            <metal:block metal:use-macro="layout.global_macros['notifications']" />
            <h3 id="pagetitle">
                <strong i18n:translate="">History for alarm:</strong>
                <em>${alarm_id}</em>
            </h3>
            <div class="large-12 columns">
                <dl class="tabs" id="alarm-subnav">
                    <dd><a href="${request.route_path('cloudwatch_alarm_view', alarm_id=alarm_id)}" i18n:translate="">General</a><dd>
                    <dd class="active">
                        <a href="">
                            History</a>
                    </dd>
                </dl>
                <div class="panel">
                    <div>
                        <magic-search template="${request.static_path('eucaconsole:static/js/thirdparty/magic-search/magic_search.html')}"
                            strings="{'remove':'${layout.searchtext_remove}', 'cancel':'${layout.searchtext_cancel}', 'prompt':'${layout.searchtext_prompt}', 'text':'${layout.searchtext_text_facet}'}"
                            facets="${search_facets}" filter-keys="${filter_keys}"></magic-search>
                    </div>
                    <p tal:condition="history is None">
                    No recent alarm activity.
                    </p>
                    <table class="table" tal:condition="history">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr tal:repeat="item history">
                                <td ng-cloak="">{{ '${item.timestamp.isoformat()}' | date: '${layout.angular_date_format}' }}</td>
                                <td>${item.tem_type}</td>
                                <td>${item.summary}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div metal:fill-slot="tail_js">
        <script src="${request.static_path('eucaconsole:static/js/thirdparty/magic-search/magic_search.js')}"></script>
        <script src="${request.static_path('eucaconsole:static/js/pages/alarms/alarm_history.js')}"></script>
    </div>
</metal:block>
